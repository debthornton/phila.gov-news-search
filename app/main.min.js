const ul=document.querySelector("ul");let form=document.querySelector("form"),api="https://www.phila.gov/wp-json/wp/v2/posts/?per_page=20";const fetchFunction=userInput=>{fetch(api).then(response=>response.json()).then(data=>{const dateFormatter=postDate=>{let dateData;const dateDataLength=10,date=postDate.substring(0,10);let day=date.substring(8,10),month=date.substring(5,7),year=date.substring(0,4),formattedDate;switch("0"==day.substring(0,1)&&(day=day.substring(1,2)),month){case"01":month="Jan.";break;case"02":month="Feb.";break;case"03":month="Mar.";break;case"04":month="Apr.";break;case"05":month="May";break;case"06":month="Jun.";break;case"07":month="Jul.";break;case"08":month="Aug.";break;case"09":month="Sep.";break;case"10":month="Oct.";break;case"11":month="Nov.";break;default:month="Dec."}return`${month} ${day}, ${year}`},resetPosts=()=>{let liArr;[...ul.querySelectorAll("li")].forEach(post=>post.remove())};(()=>{ul.children.length>0&&resetPosts();let counter=0;data.forEach(post=>{let reg=new RegExp(`${userInput}`,"i"),postTitle=post.title.rendered;if(reg.test(postTitle)||""===userInput){const li=document.createElement("li"),link=document.createElement("a"),p=document.createElement("p");p.className="title";const div=document.createElement("div");link.setAttribute("href",`${post.link}`),link.setAttribute("target","_blank"),p.textContent=postTitle,div.textContent=dateFormatter(post.date),ul.append(li),li.append(link),link.append(p),li.append(div),counter++}});let displayedLi=[...ul.querySelectorAll("li")],tabIndex=6;if(displayedLi.forEach(post=>{post.setAttribute("tabIndex",`${tabIndex}`),tabIndex++,console.log(tabIndex)}),counter<2){resetPosts();const li=document.createElement("li"),p=document.createElement("p");p.textContent="Match not found.",ul.append(li),li.append(p)}})()})};window.addEventListener("load",()=>{fetchFunction("")}),form.addEventListener("submit",e=>{let input=document.querySelector("input").value;e.preventDefault(),api=`https://www.phila.gov/wp-json/wp/v2/posts/?per_page=20&title=${input}`,fetchFunction(input)});